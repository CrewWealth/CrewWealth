l<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget - CrewWealth</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap">
    <style>
        /* CSS style blijft ongewijzigd */
    </style>
</head>
<body>
    <div class="layout">
        <!-- Sidebar -->
        <aside class="accounts-sidebar">
            <a href="/" class="sidebar-title">üí∞ CrewWealth</a>
            <!-- Accounts-secties -->
            <div class="account-section">
                <div class="account-section-header">
                    <span>All accounts</span>
                    <span id="allAccountsTotal">‚Ç¨0.00</span>
                </div>
                <div id="allAccounts"></div>
            </div>
            <div class="account-section">
                <div class="account-section-header">
                    <span>On budget</span>
                    <span id="onBudgetTotal">‚Ç¨0.00</span>
                </div>
                <div id="onBudgetAccounts"></div>
            </div>
            <div class="account-section">
                <div class="account-section-header">
                    <span>Off budget</span>
                    <span id="offBudgetTotal">‚Ç¨0.00</span>
                </div>
                <div id="offBudgetAccounts"></div>
            </div>
            <!-- Toevoegen account-knop -->
            <button class="add-account-btn" onclick="openAccountModal()">+ Add account</button>
        </aside>

        <!-- Hoofdgedeelte -->
        <main class="main-content">
            <div class="top-bar">
                <div class="top-bar-left">
                    <a href="/" class="back-btn">‚Üê Dashboard</a>
                    <h1 class="page-title">Budget</h1>
                </div>
                <div class="month-selector">
                    <button class="month-btn" onclick="changeMonth(-1)">‚óÄ</button>
                    <div class="current-month" id="currentMonth">January 2026</div>
                    <button class="month-btn" onclick="changeMonth(1)">‚ñ∂</button>
                </div>
            </div>
            
            <!-- Budgetoverzicht -->
            <div class="budget-overview">
                <div class="overview-grid">
                    <div class="overview-item">
                        <div class="overview-label">Available funds</div>
                        <div class="overview-value" id="availableFunds">‚Ç¨0.00</div>
                    </div>
                    <div class="overview-item">
                        <div class="overview-label">Overspent</div>
                        <div class="overview-value" id="overspent">‚Ç¨0.00</div>
                    </div>
                    <div class="overview-item">
                        <div class="overview-label">Budgeted</div>
                        <div class="overview-value" id="budgeted">‚Ç¨0.00</div>
                    </div>
                    <div class="overview-item">
                        <div class="overview-label">Total spent</div>
                        <div class="overview-value" id="totalSpent">‚Ç¨0.00</div>
                    </div>
                </div>
                <div class="to-budget">
                    <div class="to-budget-label">To Budget</div>
                    <div class="to-budget-value" id="toBudget">‚Ç¨0.00</div>
                </div>
            </div>

            <!-- Categorie√´n-sectie -->
            <div class="categories-section">
                <div id="categoriesContainer"></div>
                <button class="add-category-btn" onclick="openCategoryModal()">+ Add category</button>
            </div>
        </main>
    </div>

    <!-- Modals voor accounts, categorie√´n, transacties -->
    <!-- ... layouts blijven ongewijzigd ... -->

    <script>
        /* Firebase Configuratie */
        const firebaseConfig = {
            apiKey: "AIzExampleKEYexample12345",
            authDomain: "crewwealth.firebaseapp.com",
            projectId: "crewwealth",
            storageBucket: "crewwealth.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:example"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        /* Globale variabelen */
        let accounts = [];
        let categories = [];
        let budgets = {};
        let transactions = [];
        let currentDate = new Date();
        let currentUser = null;

        /* Auth check: controleer of gebruiker ingelogd is */
        auth.onAuthStateChanged((user) => {
            if (!user) {
                window.location.href = '/login';
                return;
            }
            currentUser = user;
            initDashboard();
        });

        /* Haal dashboardgegevens op en update de UI */
        async function initDashboard() {
            updateMonthDisplay();
            await loadDashboardData();
            renderAccounts(); // Accounts laden
            renderCategories(); // Categorielijst laden
            updateOverview(); // Overzicht bijwerken
        }

        /* Maandweergave bijwerken */
        function updateMonthDisplay() {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            document.getElementById('currentMonth').textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
        }

        /* Data ophalen (accounts, categorie√´n, transacties) */
        async function loadDashboardData() {
            if (!currentUser) return;
            try {
                const userId = currentUser.uid;

                // Accounts ophalen
                const accountDocs = await db.collection('users').doc(userId).collection('accounts').get();
                accounts = accountDocs.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                // Categorie√´n ophalen
                const categoryDocs = await db.collection('users').doc(userId).collection('categories').get();
                categories = categoryDocs.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                // Budget van huidige maand ophalen
                const monthKey = getMonthKey();
                const budgetDoc = await db.collection('users').doc(userId).collection('budgets').doc(monthKey).get();
                budgets = budgetDoc.exists ? budgetDoc.data() : {};
                
                console.log('‚úÖ Data succesvol geladen');
            } catch (err) {
                console.error('‚ùå Fout bij laden van dashboardgegevens', err);
                alert('Error loading data. Please try again later.');
            }
        }

        /* Render accounts in sidebar */
        function renderAccounts() {
            // Accounts verwerken: On budget en Off budget scheiden
        }

        /* Render categorie√´n in hoofdpaneel */
        function renderCategories() {
            // Dynamisch vullen gebaseerd op categorie√´n en hun respectieve budgetten
        }

        /* Update overzichtswaarden (available funds, overspent, etc.) */
        function updateOverview() {
            // Overzichtslijnen bijwerken
        }

        /* Modals openen/sluiten */
        function openAccountModal() {
            // Modal openen voor nieuw account toevoegen
        }

        function openCategoryModal() {
            // Modal openen voor nieuw categorie toevoegen
        }

        /* Overige CRUD-functies */
        // Voor Accounts, categorie√´n, budgetten, etc.
    </script>
</body>
</html>